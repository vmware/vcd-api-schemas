# ******************************************************************************
# * api-extension-template-vcloud-director
# * Copyright 2019-2021 VMware, Inc.  All rights reserved. *
# * SPDX-License-Identifier: BSD-2-Clause
# ******************************************************************************

swagger: "2.0"
info:
  description: |
    The vCloud Director Group API.
  version: "1.0"
  title: vCloud Director Group API

paths:

  groups:
    get:
      tags:
        - Group
      summary: Get a list of groups.
      x-vcloud-added-in: 35.0
      x-vcloud-multisite: true
      x-vcloud-default-sort:
        default-sort-field: name
        sort-ascending: true
      description: |
          Get a list of groups.
      operationId: queryGroups
      parameters:
          - $ref: "./common/query.yaml#/parameters/queryFilter"
          - $ref: "./common/query.yaml#/parameters/querySortAsc"
          - $ref: "./common/query.yaml#/parameters/querySortDesc"
          - $ref: "./common/query.yaml#/parameters/queryPage"
          - $ref: "./common/query.yaml#/parameters/queryPageSize"
      produces:
          - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "./ldap/ldap.yaml#/definitions/UserGroups"

    post:
      tags:
        - Group
      summary: Create a new group.
      x-vcloud-added-in: 36.0
      x-vcloud-event: com/vmware/vcloud/event/group/import
      operationId: createGroup
      consumes:
        - application/json
      parameters:
        - name: newGroup
          in: body
          required: true
          schema:
            $ref: "./ldap/ldap.yaml#/definitions/UserGroup"
      produces:
        - application/json
      responses:
        201:
          description: Created
          schema:
            $ref: "./ldap/ldap.yaml#/definitions/UserGroup"

  group:
    parameters:
      - name: groupUrn
        in: path
        description: groupUrn
        required: true
        type: string
        x-vcloud-constraints:
          - constraint: Urn
            args:
              - arg: group
    get:
      x-vcloud-added-in: 35.0
      tags:
        - Group
      summary: Get a specified group.
      operationId: getGroup
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "./ldap/ldap.yaml#/definitions/UserGroup"

    delete:
      tags:
        - Group
      summary: Delete the specified group.
      operationId: deleteGroup
      x-vcloud-added-in: 36.0
      responses:
        204:
          description: No Content

    put:
      tags:
        - Group
      summary: Modify the details of the specified group.
      operationId: updateGroup
      x-vcloud-added-in: 36.0
      x-vcloud-event: com/vmware/vcloud/event/group/modify
      description: |
        Modify details of the specified group.
      consumes:
        - application/json
      parameters:
        - name: updatedGroup
          in: body
          required: true
          schema:
            $ref: "./ldap/ldap.yaml#/definitions/UserGroup"
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "./ldap/ldap.yaml#/definitions/UserGroup"

  users:
    parameters:
      - name: groupUrn
        in: path
        description: groupUrn
        required: true
        type: string
        x-vcloud-constraints:
          - constraint: Urn
            args:
              - arg: group
    get:
      x-vcloud-added-in: 35.0
      tags:
        - Group
      summary: Get a list of users of any type that belong to the specified group.
      operationId: queryGroupUsers
      x-vcloud-default-sort:
        default-sort-field: name
        sort-ascending: true
      parameters:
        - $ref: "./common/query.yaml#/parameters/queryFilter"
        - $ref: "./common/query.yaml#/parameters/querySortAsc"
        - $ref: "./common/query.yaml#/parameters/querySortDesc"
        - $ref: "./common/query.yaml#/parameters/queryPage"
        - $ref: "./common/query.yaml#/parameters/queryPageSize"
      produces:
        - application/json
      responses:
        200:
          description: OK
          schema:
            $ref: "./common/entity.yaml#/definitions/EntityReferences"

